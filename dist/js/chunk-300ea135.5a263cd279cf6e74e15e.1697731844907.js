(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-300ea135"],{"057c":function(t,e,s){},1741:function(t,e,s){t.exports=s.p+"img/status1.e0513603.png"},"78ca":function(t,e,s){t.exports=s.p+"img/status3.1b3347fe.png"},cf5b:function(t,e,s){t.exports=s.p+"img/status2.ab1ba18b.png"},e7bc:function(t,e,s){"use strict";s("057c")},f555:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"visitorPage"},[e("div",{staticClass:"title"},[e("h3",[t._v(t._s(t.visitorName)+"提交的访客审批")]),e("p",{class:[0==t.currentStatus?"needStyle":1==t.currentStatus?"argeeStyle":2==t.currentStatus?"rejectStyle":""]},[t._v(t._s(0==t.currentStatus?"未审批":1==t.currentStatus?"已同意":2==t.currentStatus?"已拒绝":""))])]),e("div",{staticClass:"content"},[e("List",[e("ListItem",[e("span",[t._v("流水号")]),e("p",[t._v(t._s(t.flowNo))])]),e("ListItem",[e("span",[t._v("访问时间")]),e("p",[t._v(t._s(t.visitTime))])]),e("ListItem",[e("span",[t._v("被访人")]),e("p",[t._v(t._s(t.teacherName))])]),e("ListItem",[e("span",[t._v("来访目的")]),e("p",[t._v(t._s(t.visitReason))])]),e("ListItem",[e("span",[t._v("同行人员")]),e("p",t._l(t.visitorRecordList,(function(s,a){return e("Tag",{key:a},[t._v(t._s(s))])})),1)]),e("ListItem",[e("span",[t._v("登记人")]),e("p",[t._v(t._s(t.visitorName))])]),e("ListItem",[e("span",[t._v("班主任")]),e("p",[t._v(t._s(t.teacherName))])]),e("ListItem",[e("span",[t._v("身份")]),e("p",[t._v("家长")])])],1)],1),e("div",{staticClass:"cardStep"},[e("h3",[t._v("审批流程")]),e("Timeline",t._l(t.spList,(function(s,a){return e("TimelineItem",{key:a,scopedSlots:t._u([{key:"dot",fn:function(){return[e("span",{staticClass:"name"},[t._v(t._s(0==a?"家":s.refPersonName.charAt(0)))])]},proxy:!0}],null,!0)},[e("div",[e("div",{staticClass:"doThing"},[e("div",[e("span",[t._v(t._s(s.optPersonTypeStr))]),e("span",{class:["statusStyle",0==t.currentStatus?"needStyle":1==t.currentStatus?"argeeStyle":2==t.currentStatus?"rejectStyle":""]},[t._v(" "+t._s(1==s.currentStatus?"(已同意)":2==s.currentStatus?"(已拒绝)":3==s.currentStatus?"(已撤回)":0==s.currentStatus&&0!==a?"(未审批)":"")+" ")])]),e("span",{staticClass:"time"},[t._v(t._s(s.createTime))])]),e("p",{staticClass:"namedetail"},[t._v(" "+t._s(""!=s.currentStatus&&null!=s.currentStatus||0!=a?s.refPersonName:"家长")+" ")])])])})),1)],1),e("img",{staticClass:"statusImg",attrs:{src:0==t.currentStatus?t.status1:1==t.currentStatus?t.status2:2==t.currentStatus?t.status3:"",alt:""}}),2==t.roleId&&0==t.currentStatus?e("div",{staticClass:"spDom"},[e("Button",{staticClass:"aggreeBtn",attrs:{type:"primary"},on:{click:function(e){return t.aggreeBtn(1)}}},[t._v("同意")]),e("Button",{staticClass:"rejectBtn",attrs:{type:"success",ghost:""},on:{click:function(e){return t.aggreeBtn(2)}}},[t._v("驳回")])],1):t._e(),e("Loading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]})],1)},n=[],i=s("ade3"),o=(s("a9e3"),s("14d9"),s("ac1f"),s("5319"),s("b1d0")),r=s("1271"),c=s("3b2d"),u=s("1741"),d=s.n(u),l=s("cf5b"),v=s.n(l),p=s("78ca"),m=s.n(p),h={name:"index",data:function(){var t;return t={title:"详情",visitorName:"",eventId:"",studentId:"",optPhone:"",roleId:"",spList:[],flowNo:"",teacherName:"",visitReason:"",visitorRecordList:[]},Object(i["a"])(t,"visitorName",""),Object(i["a"])(t,"sfzType",""),Object(i["a"])(t,"visitTime",""),Object(i["a"])(t,"currentStatus",""),Object(i["a"])(t,"status1",d.a),Object(i["a"])(t,"status2",v.a),Object(i["a"])(t,"status3",m.a),Object(i["a"])(t,"isLoading",!0),t},created:function(){document.title=this.title,this.eventId=c["a"].getQueryVariable("eventId"),this.studentId=Number(c["a"].getQueryVariable("studentId")),this.optPhone=Number(c["a"].getQueryVariable("optPhone")),this.roleId=c["a"].getQueryVariable("roleType"),this.getDetailFun()},activated:function(){document.title=this.title},mounted:function(){},methods:{handleAdd:function(){this.$router.push({path:"guestadd",query:{studentId:this.studentId,optPhone:this.optPhone,roleId:this.roleId}})},getDetailFun:function(){var t=this;this.isLoading=!0,Object(o["a"])({method:"get",url:r["a"].recordUrl.findDetail+"?studentId="+Number(this.studentId)+"&eventId="+Number(this.eventId),data:{},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){if(console.log("res",e),t.isLoading=!1,200==e.code){console.log("返回数据",e),t.spList=e.data.eventHistory,t.visitorName=e.data.event.visitorName,t.approveStr=e.data.event.approveStr,t.flowNo=e.data.event.flowNo,t.visitTime=e.data.event.startTime,t.teacherName=e.data.event.teacherName,t.visitReason=e.data.event.visitReason;for(var s=e.data.visitorRecordList,a=0;a<s.length;a++)t.visitorRecordList.push(s[a].visitName);t.visitorName=e.data.event.visitorName,t.sfzType=e.data.event.visitorIdentity,t.currentStatus=e.data.event.currentStatus}else t.$Message.info(e.msg)})).catch((function(t){console.log(t)}))},aggreeBtn:function(t){var e=this;this.isLoading=!0,Object(o["a"])({method:"post",url:r["a"].recordUrl.visitApprove,data:{eventId:Number(this.eventId),recStatus:t},headers:{"Content-Type":"application/json"}}).then((function(t){console.log("res",t),e.isLoading=!1,200==t.code?(console.log("返回数据",t),e.$Message.info(t.msg),setTimeout((function(){void 0==e.roleId&&(e.roleId=c["a"].getQueryVariable("roleType")),void 0==e.token&&(e.token=c["a"].getQueryVariable("openId"));var t=window.location.protocol+"//"+window.location.hostname+"/event/index.html#/guestIndex?roleType="+e.roleId+"&studentId="+e.studentId+"&openId="+e.token+"&phone="+e.optPhone;console.log("url",t),location.replace(t)}),1500)):e.$Message.info(t.msg)})).catch((function(t){console.log(t)}))}}},g=h,f=(s("e7bc"),s("2877")),_=Object(f["a"])(g,a,n,!1,null,"3b530803",null);e["default"]=_.exports}}]);