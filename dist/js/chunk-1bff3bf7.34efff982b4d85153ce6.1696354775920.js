(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1bff3bf7"],{"00b4":function(t,e,i){"use strict";i("ac1f");var s=i("23e7"),o=i("c65b"),n=i("1626"),a=i("825a"),m=i("577e"),r=function(){var t=!1,e=/[ac]/;return e.exec=function(){return t=!0,/./.exec.apply(this,arguments)},!0===e.test("abc")&&t}(),c=/./.test;s({target:"RegExp",proto:!0,forced:!r},{test:function(t){var e=a(this),i=m(t),s=e.exec;if(!n(s))return o(c,e,i);var r=o(s,e,i);return null!==r&&(a(r),!0)}})},"296d":function(t,e,i){"use strict";i.r(e);i("b0c0");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"guestAddPage"},[e("Form",{attrs:{model:t.formItem,"label-width":90}},[t._l(t.formItemList,(function(i,s){return e("div",{key:s},[e("p",{staticClass:"dataTitle"},[t._v(t._s("访客"+(s+1)))]),e("FormItem",{attrs:{label:"访客姓名"}},[e("Input",{attrs:{placeholder:"请输入..."},model:{value:i.visitName,callback:function(e){t.$set(i,"visitName",e)},expression:"item.visitName"}})],1),e("FormItem",{attrs:{label:"访客手机"}},[e("Input",{attrs:{placeholder:"请输入..."},model:{value:i.phone,callback:function(e){t.$set(i,"phone",e)},expression:"item.phone"}})],1),e("FormItem",{attrs:{label:"访客身份证"}},[e("Input",{attrs:{placeholder:"请输入..."},model:{value:i.visitorIdentity,callback:function(e){t.$set(i,"visitorIdentity",e)},expression:"item.visitorIdentity"}})],1)],1)})),e("div",{staticClass:"addPer"},[e("Icon",{attrs:{type:"md-add"}}),e("Button",{attrs:{type:"text"},on:{click:t.addPer}},[t._v("添加同行人")])],1)],2),e("p",{staticClass:"divider"},[t._v("访问信息")]),e("Form",{staticClass:"detailMsg",attrs:{model:t.formItemTime,"label-position":"top","label-width":66}},[e("FormItem",{attrs:{label:"选择时间"}},[e("Row",[e("Col",{attrs:{span:"11"}},[e("DatePicker",{attrs:{type:"datetime",placeholder:"选择起始时间","start-date":new Date,format:"yyyy-MM-dd HH:mm"},on:{"on-ok":function(e){return t.choseStartTime()},"on-clear":function(e){return t.clearStartTime()}},model:{value:t.formItemTime.startTime,callback:function(e){t.$set(t.formItemTime,"startTime",e)},expression:"formItemTime.startTime"}})],1),e("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[t._v("-")]),e("Col",{attrs:{span:"11"}},[e("DatePicker",{attrs:{type:"datetime",placeholder:"选择结束时间","start-date":new Date,format:"yyyy-MM-dd HH:mm"},on:{"on-ok":function(e){return t.choseEndTime()},"on-clear":function(e){return t.clearEndTime()}},model:{value:t.formItemTime.endTime,callback:function(e){t.$set(t.formItemTime,"endTime",e)},expression:"formItemTime.endTime"}})],1)],1)],1)],1),e("Form",{attrs:{model:t.formItemMsg,"label-width":90}},[e("FormItem",{attrs:{label:"来访目的"}},[e("Input",{attrs:{maxlength:"10",placeholder:"请输入（最多10个字）"},model:{value:t.formItemMsg.visitReason,callback:function(e){t.$set(t.formItemMsg,"visitReason",e)},expression:"formItemMsg.visitReason"}})],1),e("FormItem",{attrs:{label:"到访地址"}},[e("Input",{attrs:{type:"textarea",maxlength:"20",placeholder:"请输入（最多20个字）"},model:{value:t.formItemMsg.vistDestination,callback:function(e){t.$set(t.formItemMsg,"vistDestination",e)},expression:"formItemMsg.vistDestination"}})],1)],1),t.isStudent?e("Form",{attrs:{model:t.formItemPer,"label-width":90}},[e("FormItem",{attrs:{label:"就读学生"}},[e("Input",{model:{value:t.formItemPer.name,callback:function(e){t.$set(t.formItemPer,"name",e)},expression:"formItemPer.name"}})],1)],1):t._e(),e("Button",{staticClass:"submitBtn",attrs:{type:"primary"},on:{click:t.shureSubmit}},[t._v("确认预约")])],1)},o=[],n=i("ade3"),a=(i("14d9"),i("4d63"),i("c607"),i("ac1f"),i("2c3e"),i("25f0"),i("00b4"),i("b1d0")),m=i("1271"),r=i("3b2d"),c={name:"index",data:function(){return{title:"访客预约",isStudent:!1,optPhone:"",formItem:{visitorName:"",visitorPhone:"",visitorIdentity:""},formItemTime:{startTime:"",endTime:""},formItemMsg:{visitReason:"",vistDestination:""},formItemList:[{visitName:"",phone:"",visitorIdentity:""}],formItemPer:{name:"马小乔",studentId:111}}},created:function(){document.title=this.title,this.optPhone=this.$route.query.optPhone},activated:function(){document.title=this.title},mounted:function(){},methods:Object(n["a"])({addAskFun:function(){var t=this,e={visitorName:this.formItemList[0].visitName,visitorPhone:this.formItemList[0].phone,visitorIdentity:this.formItemList[0].visitorIdentity,startTime:r["a"].changeTimeFormat(this.formItemTime.startTime),endTime:r["a"].changeTimeFormat(this.formItemTime.endTime),visitReason:this.formItemMsg.visitReason,vistDestination:this.formItemMsg.vistDestination,visitorRecordList:this.formItemList,studentId:157441,optPhone:this.optPhone};console.log("params",e),Object(a["a"])({method:"post",url:m["a"].recordUrl.visitoradd,data:e,headers:{"Content-Type":"application/json"}}).then((function(e){console.log("res",e),200==e.code?(console.log("res",e),t.$Message.info(e.msg),setTimeout((function(){t.$router.go(-1)}),1500)):t.$Message.info(e.msg)})).catch((function(t){console.log(t)}))},addPer:function(){this.formItemList.push({visitName:"",phone:"",visitorIdentity:""})},shureSubmit:function(){var t=new RegExp("^1[3578]\\d{9}$");this.formItemList[0].visitName?this.formItemList[0].phone?t.test(this.formItemList[0].phone)?this.formItemList[0].visitorIdentity?this.isValidIDCard(this.formItemList[0].visitorIdentity)?this.formItemTime.startTime?this.formItemTime.endTime?this.formItemMsg.visitReason?this.formItemMsg.vistDestination?this.addAskFun():this.$Message.info("到访地址不能为空"):this.$Message.info("访客目的不能为空"):this.$Message.info("访客结束时间不能为空"):this.$Message.info("访客开始时间不能为空"):this.$Message.info("访客身份证格式错误"):this.$Message.info("访客身份证不能为空"):this.$Message.info("访客手机格式错误"):this.$Message.info("访客手机不能为空"):this.$Message.info("访客姓名不能为空")},isValidIDCard:function(t){var e=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return e.test(t)},choseStartTime:function(){if(this.formItemTime.endTime){var t=this.formItemTime.startTime.getTime(),e=this.formItemTime.endTime.getTime();t>e&&(this.$Message.info("结束时间不能小于开始时间"),this.formItemTime.startTime="")}},choseEndTime:function(){if(this.formItemTime.startTime){var t=this.formItemTime.startTime.getTime(),e=this.formItemTime.endTime.getTime();t>e&&(this.$Message.info("结束时间不能小于开始时间"),this.formItemTime.endTime="")}},clearStartTime:function(){this.formValidate.startTime=""}},"clearStartTime",(function(){this.formValidate.endTime=""}))},l=c,d=(i("fc60"),i("2877")),f=Object(d["a"])(l,s,o,!1,null,"0ec8f1cd",null);e["default"]=f.exports},b0c0:function(t,e,i){"use strict";var s=i("83ab"),o=i("5e77").EXISTS,n=i("e330"),a=i("edd0"),m=Function.prototype,r=n(m.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=n(c.exec),d="name";s&&!o&&a(m,d,{configurable:!0,get:function(){try{return l(c,r(this))[1]}catch(t){return""}}})},da48:function(t,e,i){},fc60:function(t,e,i){"use strict";i("da48")}}]);