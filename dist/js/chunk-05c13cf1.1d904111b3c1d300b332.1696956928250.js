(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05c13cf1"],{"00b4":function(t,e,i){"use strict";i("ac1f");var s=i("23e7"),n=i("c65b"),o=i("1626"),a=i("825a"),r=i("577e"),m=function(){var t=!1,e=/[ac]/;return e.exec=function(){return t=!0,/./.exec.apply(this,arguments)},!0===e.test("abc")&&t}(),l=/./.test;s({target:"RegExp",proto:!0,forced:!m},{test:function(t){var e=a(this),i=r(t),s=e.exec;if(!o(s))return n(l,e,i);var m=n(s,e,i);return null!==m&&(a(m),!0)}})},"296d":function(t,e,i){"use strict";i.r(e);i("b0c0");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"guestAddPage"},[e("Form",{attrs:{model:t.formItem,"label-width":90}},[t._l(t.formItemList,(function(i,s){return e("div",{key:s},[e("p",{staticClass:"dataTitle"},[t._v(t._s("访客"+(s+1)))]),e("FormItem",{attrs:{label:"访客姓名"}},[e("Input",{attrs:{placeholder:"请输入..."},model:{value:i.visitName,callback:function(e){t.$set(i,"visitName",e)},expression:"item.visitName"}})],1),e("FormItem",{attrs:{label:"访客手机"}},[e("Input",{attrs:{placeholder:"请输入..."},model:{value:i.phone,callback:function(e){t.$set(i,"phone",e)},expression:"item.phone"}})],1),e("FormItem",{attrs:{label:"访客身份证"}},[e("Input",{attrs:{placeholder:"请输入..."},model:{value:i.visitorIdentity,callback:function(e){t.$set(i,"visitorIdentity",e)},expression:"item.visitorIdentity"}})],1)],1)})),e("div",{staticClass:"addPer"},[e("Icon",{attrs:{type:"md-add"}}),e("Button",{attrs:{type:"text"},on:{click:t.addPer}},[t._v("添加同行人")])],1)],2),e("p",{staticClass:"divider"},[t._v("访问信息")]),e("Form",{staticClass:"detailMsg",attrs:{model:t.formItemTime,"label-position":"top","label-width":66}},[e("FormItem",{attrs:{label:"选择时间"}},[e("Row",[e("Col",{attrs:{span:"11"}},[e("DatePicker",{attrs:{type:"datetime",placeholder:"选择起始时间","start-date":new Date,disabled:t.isdisAbled,format:"yyyy-MM-dd HH:mm"},on:{"on-ok":function(e){return t.choseStartTime()},"on-change":function(e){return t.choseStartTime()},"on-clear":function(e){return t.clearStartTime()}},model:{value:t.formItemTime.startTime,callback:function(e){t.$set(t.formItemTime,"startTime",e)},expression:"formItemTime.startTime"}})],1),e("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[t._v("-")]),e("Col",{attrs:{span:"11"}},[e("DatePicker",{attrs:{type:"datetime",placeholder:"选择结束时间","start-date":new Date,disabled:t.isdisAbled,format:"yyyy-MM-dd HH:mm"},on:{"on-ok":function(e){return t.choseEndTime()},"on-change":function(e){return t.choseEndTime()},"on-clear":function(e){return t.clearEndTime()}},model:{value:t.formItemTime.endTime,callback:function(e){t.$set(t.formItemTime,"endTime",e)},expression:"formItemTime.endTime"}})],1)],1)],1)],1),e("Form",{attrs:{model:t.formItemMsg,"label-width":90}},[e("FormItem",{attrs:{label:"来访目的"}},[e("Input",{attrs:{maxlength:"10",placeholder:"请输入（最多10个字）"},model:{value:t.formItemMsg.visitReason,callback:function(e){t.$set(t.formItemMsg,"visitReason",e)},expression:"formItemMsg.visitReason"}})],1),e("FormItem",{attrs:{label:"到访地址"}},[e("Input",{attrs:{type:"textarea",maxlength:"20",placeholder:"请输入（最多20个字）"},model:{value:t.formItemMsg.visitDestination,callback:function(e){t.$set(t.formItemMsg,"visitDestination",e)},expression:"formItemMsg.visitDestination"}})],1)],1),t.isStudent?e("Form",{attrs:{model:t.formItemPer,"label-width":90}},[e("FormItem",{attrs:{label:"就读学生"}},[e("Input",{model:{value:t.formItemPer.name,callback:function(e){t.$set(t.formItemPer,"name",e)},expression:"formItemPer.name"}})],1)],1):t._e(),e("Button",{staticClass:"submitBtn",attrs:{type:"primary"},on:{click:t.shureSubmit}},[t._v("确认预约")])],1)},n=[],o=i("ade3"),a=(i("a9e3"),i("ac1f"),i("5319"),i("14d9"),i("4d63"),i("c607"),i("2c3e"),i("25f0"),i("00b4"),i("b1d0")),r=i("1271"),m=i("3b2d"),l={name:"index",data:function(){return{title:"访客预约",isStudent:!1,optPhone:"",formItem:{visitorName:"",visitorPhone:"",visitorIdentity:""},formItemTime:{startTime:"",endTime:""},formItemMsg:{visitReason:"",visitDestination:""},formItemList:[{visitName:"",phone:"",visitorIdentity:""}],formItemPer:{name:"",studentId:""},roleType:"",eventType:1,inviteCount:0,isdisAbled:!1,inviteId:""}},created:function(){document.title=this.title,this.optPhone=m["a"].getQueryVariable("optPhone"),m["a"].getQueryVariable("inviteId")&&(this.inviteId=Number(m["a"].getQueryVariable("inviteId"))),m["a"].getQueryVariable("startTime")&&(this.isdisAbled=!0,this.formItemTime.startTime=m["a"].shijianc(Number(m["a"].getQueryVariable("startTime")))),m["a"].getQueryVariable("endTime")&&(this.isdisAbled=!0,this.formItemTime.endTime=m["a"].shijianc(Number(m["a"].getQueryVariable("endTime")))),m["a"].getQueryVariable("inviteCount")&&(this.inviteCount=m["a"].getQueryVariable("inviteCount")),m["a"].getQueryVariable("roleType")&&(this.roleType=m["a"].getQueryVariable("roleType")),m["a"].getQueryVariable("eventType")&&(this.eventType=m["a"].getQueryVariable("eventType")),m["a"].getQueryVariable("studentId")&&(this.formItemPer.studentId=m["a"].getQueryVariable("studentId"))},activated:function(){document.title=this.title},mounted:function(){},methods:Object(o["a"])({addAskFun:function(){var t=this,e={visitorName:this.formItemList[0].visitName,visitorPhone:this.formItemList[0].phone,visitorIdentity:this.formItemList[0].visitorIdentity,startTime:m["a"].getQueryVariable("startTime")?this.formItemTime.startTime:m["a"].changeTimeFormat(this.formItemTime.startTime),endTime:m["a"].getQueryVariable("endTime")?this.formItemTime.endTime:m["a"].changeTimeFormat(this.formItemTime.endTime),visitReason:this.formItemMsg.visitReason,visitDestination:this.formItemMsg.visitDestination,visitorRecordList:this.formItemList,studentId:this.formItemPer.studentId,optPhone:this.optPhone,inviteId:this.inviteId,eventType:this.eventType};console.log("params",e),Object(a["a"])({method:"post",url:r["a"].recordUrl.visitoradd,data:e,headers:{"Content-Type":"application/json"}}).then((function(e){console.log("res",e),200==e.code?(console.log("res",e),t.$Message.info(e.msg),setTimeout((function(){var e=window.location.protocol+"//"+window.location.hostname+"/event/index.html#/guestIndex?roleType="+t.roleType+"&studentId="+t.formItemPer.studentId+"&openId="+t.token+"&phone="+t.optPhone;location.replace(e)}),1500)):t.$Message.info(e.msg)})).catch((function(t){console.log(t)}))},addPer:function(){console.log("this.formItemList.length",this.formItemList.length+1),console.log("this.inviteCount",this.inviteCount),0!==this.inviteCount&&this.formItemList.length+1>this.inviteCount?this.$Message.info("已超出访问人数上限"):this.formItemList.push({visitName:"",phone:"",visitorIdentity:""})},shureSubmit:function(){var t=new RegExp("^1[3578]\\d{9}$");this.formItemList[0].visitName?this.formItemList[0].phone?t.test(this.formItemList[0].phone)?this.formItemList[0].visitorIdentity?this.isValidIDCard(this.formItemList[0].visitorIdentity)?this.formItemTime.startTime?this.formItemTime.endTime?this.formItemMsg.visitReason?this.formItemMsg.visitDestination?this.addAskFun():this.$Message.info("到访地址不能为空"):this.$Message.info("访客目的不能为空"):this.$Message.info("访客结束时间不能为空"):this.$Message.info("访客开始时间不能为空"):this.$Message.info("访客身份证格式错误"):this.$Message.info("访客身份证不能为空"):this.$Message.info("访客手机格式错误"):this.$Message.info("访客手机不能为空"):this.$Message.info("访客姓名不能为空")},isValidIDCard:function(t){var e=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return e.test(t)},choseStartTime:function(){if(this.formItemTime.endTime){var t=this.formItemTime.startTime.getTime(),e=this.formItemTime.endTime.getTime();t>e?(this.$Message.info("结束时间不能小于开始时间"),this.formItemTime.startTime=""):t==e&&(this.$Message.info("开始时间与结束时间一致"),this.formItemTime.startTime="")}},choseEndTime:function(){if(this.formItemTime.startTime){var t=this.formItemTime.startTime.getTime(),e=this.formItemTime.endTime.getTime();t>e?(this.$Message.info("结束时间不能小于开始时间"),this.formItemTime.endTime=""):t==e&&(this.$Message.info("开始时间与结束时间一致"),this.formItemTime.endTime="")}},clearStartTime:function(){this.formValidate.startTime=""}},"clearStartTime",(function(){this.formValidate.endTime=""}))},d=l,c=(i("c7b6"),i("2877")),u=Object(c["a"])(d,s,n,!1,null,"9edfeddc",null);e["default"]=u.exports},5991:function(t,e,i){},b0c0:function(t,e,i){"use strict";var s=i("83ab"),n=i("5e77").EXISTS,o=i("e330"),a=i("edd0"),r=Function.prototype,m=o(r.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,d=o(l.exec),c="name";s&&!n&&a(r,c,{configurable:!0,get:function(){try{return d(l,m(this))[1]}catch(t){return""}}})},c7b6:function(t,e,i){"use strict";i("5991")}}]);